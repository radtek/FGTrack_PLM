SELECT
    PARTY_ID,
    PARTY_NAME,
    WH_ID,
    PRODUCT_NO,
    PRODUCT_NAME,
    PRODUCT_TYPE_ID,
    PRODUCT_TYPE_NAME,
    BOX_QTY,
    QTY,
    NO_OF_BOX,
    MAX(FLAG)
FROM STOCK_BY_CUSTOMER
WHERE  UPPER( WH_ID ) LIKE '%' || UPPER( @strWH_ID ) || '%'
GROUP BY PARTY_ID,
	 PARTY_NAME,
	 WH_ID,
	 PRODUCT_NO,
	 PRODUCT_NAME,
	 PRODUCT_TYPE_ID,
	 PRODUCT_TYPE_NAME,
	 BOX_QTY,
	 QTY,
	 NO_OF_BOX; 

